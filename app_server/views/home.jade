extends layout
include _includes/sharedHTMLfunctions

block content
  .row.banner
    .col-12.text-center  
      img(src="images/roastlogo.jpg", alt="Roast Logo", class="img-fluid", style="max-width: 800px;") 
      h1 Welcome to Roast CafÃ©
      p Discover the finest coffees and pastries made with love and local ingredients.

  // Main Content Area
  .row
    .col-12.col-md-8
      // Coffee Section
      .card
        .card-block
          h4
            a(href="/location") Coffee
          .row
            .col-6
              p.facilities
                span.badge.badge-warning Coffee is a beloved beverage made from roasted coffee beans.
                span.badge.badge-warning The seeds of the Coffea plant. Ground and brewed with hot water,
                span.badge.badge-warning it offers a rich array of flavors and aromas. Enjoyed globally in 
                span.badge.badge-warning forms like espresso, lattes, and cold brews.
                span.badge.badge-warning Coffee is celebrated for its stimulating effects due to caffeine.
                span.badge.badge-warning Beyond its taste, coffee holds cultural significance, often serving 
                span.badge.badge-warning as a social catalyst in gatherings and daily routines, making it a 
                span.badge.badge-warning cherished part of many people's lives.
            .col-6
              img(src="images/coffee.jpg", alt="Cappuccino Image", class="img-fluid")

      // Pastries Section
      .card
        .card-block
          h4
            a(href="/pastries") Pastries
          .row
            .col-6
              p.facilities
                span.badge.badge-warning Pastries are delightful baked goods made from ingredients like flour,
                span.badge.badge-warning butter, and sugar, offering a range of sweet and savory flavors.
                span.badge.badge-warning From buttery croissants to rich chocolate muffins, pastries
                span.badge.badge-warning provide a delicious treat for any time of day. These confections are 
                span.badge.badge-warning often enjoyed with coffee or tea, adding a touch of indulgence 
                span.badge.badge-warning to morning routines or snack times.
            .col-6
              img(src="images/pastrylogo.jpg", alt="Pastries Image", class="img-fluid")

      // Tea Section
      .card
        .card-block
          h4
            a(href="/tea") Tea
          .row
            .col-6
              p.facilities
                span.badge.badge-warning Tea is a popular beverage made by steeping cured or fresh 
                span.badge.badge-warning tea leaves in hot water. It comes in various types, including black, 
                span.badge.badge-warning green, white, and herbal, each offering unique flavors 
                span.badge.badge-warning and health benefits. Enjoyed both hot and cold, tea is a staple in
                span.badge.badge-warning many cultures worldwide.
                  
            .col-6
              img(src="images/tea.jpg", alt="Tea Image", class="img-fluid")

    // Add Review Section on the Right Side
    .col-12.col-md-4
      .card
        .card-block
          h4 Add Review
          p Share your experience with us!
          a(href="/location/review/new", class="btn btn-primary") Add Review 

      // Customer Reviews Section
      .reviews-container
        h5 Customer Reviews
        // Existing and new reviews will be dynamically appended here

    .col-12
      p.lead
        | Join us for a delightful experience, and don't forget to try our special blends and treats!

  script.
    // Fetch reviews on page load
    window.onload = async function() {
      try {
        const response = await fetch('/api/reviews'); // Fetch reviews from API
        if (response.ok) {
          const reviews = await response.json();
          reviews.forEach(review => {
            displayNewReview(review); // Display each review dynamically
          });
        }
      } catch (err) {
        console.error('Error fetching reviews:', err);
      }
    };

    // Function to display a review dynamically in the .reviews-container
          
    function displayNewReview(review) {
    if (review && review.name && review.rating !== undefined && review.review) {
      const reviewsContainer = document.querySelector('.reviews-container');
      const reviewHTML = `
        <div class="card mb-2">
          <div class="card-block">
            <h5>${review.name}</h5>
            <p>Rating: ${review.rating}</p>
            <p>${review.review}</p>
          </div>
        </div>
      `;
      reviewsContainer.innerHTML += reviewHTML;
    }else {
      console.warn('Received an undefined or incomplete review:', review);
     }
    }
    fetchReviews();